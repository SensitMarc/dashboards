<!DOCTYPE html>
<html>
<head>
  <title>Energy &raquo; usage</title>
  <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />
  <link rel="stylesheet" type="text/css" href="../../assets/lib/bootstrap/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../../assets/css/keen-dashboards.css" />

<meta charset='utf-8' />
    <title></title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.20.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.20.0/mapbox-gl.css' rel='stylesheet' />




</head>
    


  <div class="container-fluid">

    <div class="row">
      <div class="col-sm-4 col-md-4">
        <div class="chart-wrapper">
          <div class="chart-title">
           KWHR USAGE
          </div>
          <div class="chart-stage">
            <div id="mychart">
            
            </div>
          </div>
          <div class="chart-notes">
            TODAY
          </div>
        </div>
      </div>
      
     <div class="col-sm-4 col-md-4">
        <div class="chart-wrapper">
          <div class="chart-title">
            KWHR USAGE
          </div>
          <div class="chart-stage">
            <div id="mychartt">
            
            </div>
          </div>
          <div class="chart-notes">
            THIS MONTH
          </div>
        </div>
      </div>
   
    <div class="row">
      <div class="col-sm-11 col-md-11">
        <div class="chart-wrapper">
          <div class="chart-title">
           STATE
          </div>
          <div class="chart-stage">
            <div id="state">
            
            </div>
          </div>
          <div class="chart-notes">
            
          </div>
        </div>
      </div>


    <div class="row">
      <div class="col-sm-6 col-md-4">
        <div class="chart-wrapper">
          <div class="chart-title">
            DAILY KWHR USAGE
          </div>
          <div class="chart-stage">
            <div id="mycharttt">
            
            </div>
          </div>
          <div class="chart-notes">
            LAST 30 DAYS
          </div>
        </div>
      </div>
       
       
      <div class="col-sm-6 col-md-4">
        <div class="chart-wrapper">
          <div class="chart-title">
            HOURLY KWHR USAGE
          </div>
          <div class="chart-stage">
            <div id="hourlykwhr">
            
            </div>
          </div>
          <div class="chart-notes">
            LAST 1 DAYS
          </div>
        </div>
      </div>

      <div class="col-sm-6 col-md-4">
        <div class="chart-wrapper">
          <div class="chart-title">
            LEADERBOARD
          </div>
          <div class="chart-stage">
            <div id="leader">
            
            </div>
          </div>
          <div class="chart-notes">
            LAST 30 DAYS
          </div>
        </div>
      </div>
      

       <div class="row">
            <div class="col-sm-2 col-md-12" id="mapwrap">
        <div class="chart-wrapper">
          <div class="chart-title">
             AVERAGE KWHR USAGE PER CAPITA
            </div>
          <div class="chart-stage">
             <div id="map" style="width: 2000px; height: 300px;">
               
          </div>
          </div>
          <div class="chart-notes">
             MONTHLY
          </div>
        </div>
      </div>
 </div>
       
    <hr>

    <p class="small text-muted">Built with &#9829; by <a href="https://keen.io">Marc</a></p>

  </div>

  <script type="text/javascript" src="../../assets/lib/jquery/dist/jquery.min.js"></script>
  <script type="text/javascript" src="../../assets/lib/bootstrap/dist/js/bootstrap.min.js"></script>

  <script type="text/javascript" src="../../assets/lib/holderjs/holder.js"></script>
  <script>
    Holder.add_theme("white", { background:"#fff", foreground:"#a7a7a7", size:10 });
  </script>

  <script type="text/javascript" src="../../assets/lib/keen-js/dist/keen.min.js"></script>
  <script type="text/javascript" src="../../assets/js/meta.js"></script>

<script>
var client = new Keen({
  projectId: "563a13c896773d4a75c3bf93",
  readKey: "9d45d36b3d3040533eb3a9f2e8bcc9e317d6b4e7e2cbb413ce959e7c0f8b926a7b82523fc0acd774ef024a0f4bddcc2bd8e992e2f61d9aed7b7f09bcb63bc0a1ebee2e0ebd0e2792dba3dc4ae1ae9c11c19e54753574a726dea4eec16e463aa06196d6876d167a9d668f236f25a8857d"

});

Keen.ready(function(){
  
  var today = new Keen.Query("count", {
    eventCollection: "kWhr",
    filters: [
    {
        "operator": "eq",
        "property_name": "coreid",
        "property_value": "51ff67065067545711360687"
    }
],
    timeframe: "this_1_days",
    timezone: "America/Sao_Paulo"
  });
  
  var month = new Keen.Query("count", {
    eventCollection: "kWhr",
    filters: [
    {
        "operator": "eq",
        "property_name": "coreid",
        "property_value": "51ff67065067545711360687"
    }
],
    timeframe: "this_30_days",
    timezone: "America/Sao_Paulo"
  });
  
    var monthchart = new Keen.Query("count", {
    eventCollection: "kWhr",

    interval:"daily",
    timeframe: "this_30_days",
    timezone: "America/Sao_Paulo"
  });
  
      var queryhourlykwhr = new Keen.Query("count", {
    eventCollection: "kWhr",
        groupBy: [
    "event"
],
    filters: [
    {
        "operator": "eq",
        "property_name": "coreid",
        "property_value": "51ff67065067545711360687"
    }
],
    interval: "hourly",
    timeframe: "this_1_days",
    timezone: "America/Sao_Paulo"
  });
  
  var state = new Keen.Query("count_unique", {
    eventCollection: "collect",
    targetProperty: "event",
    filters: [
    {
        "operator": "eq",
        "property_name": "coreid",
        "property_value": "51ff67065067545711360687"
        
    }
],
    timeframe: "this_1_days",
    timezone: "America/Sao_Paulo"
  });
  
  var state = new Keen.Query("count", {
    eventCollection: "sensee",
    groupBy: [
    "event"
],
    interval: "minutely",
    timeframe: "this_1_hours",
    timezone: "UTC"
  });
  
  
    var leader = new Keen.Query("count", {
    eventCollection: "kWhr",
    groupBy: [
    "coreid"
],
    timeframe: "this_30_days",
    timezone: "America/Sao_Paulo"
  });
  
  
       // and draw a column chart
     client.draw(today, document.getElementById("mychart"), {
        chartType: "metric",
        title: "today",
        height: 250,
        width: "auto",
        chartOptions: {
          chartOptions: {
            isStacked: true
          }
        }
      });
      
           client.draw(month, document.getElementById("mychartt"), {
        chartType: "metric",
        title: "this month",
        height: 250,
        width: "auto",
          chartOptions: {
            chartOptions: {
            isStacked: true
          }
        }
      });
      
client.draw(monthchart, document.getElementById("mycharttt"), {
  chartType: "columnchart",
  title: "daily",
  height: 250,
  width: "auto",
  chartOptions: {
     chartOptions: {
      isStacked: true
          }
  }
  });

client.draw(queryhourlykwhr, document.getElementById("hourlykwhr"), {
  chartType: "columnchart",
  title: "hourly",
  height: 250,
  width: "auto",
  chartOptions: {
     chartOptions: {
      isStacked: true
          }
  }
  });
  
client.draw(leader, document.getElementById("leader"), {
  chartType: "barchart",
  title: "last 30 days",
  height: 250,
  width: "auto",
  chartOptions: {
     chartOptions: {
      isStacked: true
          }
  }
  });
  
  
  client.draw(state, document.getElementById("state"), {
        chartType: "columnchart",
       title: "state", 
        height: 250,
        width: "auto",
          chartOptions: {
            chartOptions: {
            isStacked: true
          }
        }
      });
});
    
</script>

<div id='map'></div>

<script>
mapboxgl.accessToken = 'pk.eyJ1Ijoic2Vuc2l0IiwiYSI6ImNpZ2hwb2VlbTgzbjJ2OG03ZmhweGNqZzAifQ.YCcLyhXq7MXpRJDXojNtCg';
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/streets-v9',
    center: [20, 56],
    zoom: 1
});

map.on('load', function () {
    map.addSource("markers", {
        "type": "geojson",
        "data": {
            "type": "FeatureCollection",
            "features": [{
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [-66.4619, 46.5653]
                },
                "properties": {
                    "title": "1340",
                    "marker-symbol": "rocket"
                }
            }, {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [-106.3468, 55.1304]
                },
                "properties": {
                    "title": "900",
                    "marker-symbol": "rocket"
                   
                }
            }]
        }
    });

    map.addLayer({
        "id": "markers",
        "type": "symbol",
        "source": "markers",
        "layout": {
            "icon-image": "{marker-symbol}-15",
            "text-field": "{title}",
            "text-font": ["Open Sans Semibold", "Arial Unicode MS Bold"],
            "text-offset": [0, 0.6],
            "text-anchor": "top"
        }
    });
});

</script>
</body>
</html>
